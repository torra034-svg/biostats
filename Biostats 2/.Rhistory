# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2
library(tidyverse)
# Chunk 3
url <- "https://raw.githubusercontent.com/torra034-svg/biostats/refs/heads/main/Biostats%202/Data%20Stuff/tomhs.csv"
tomhs <- read_csv(url)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2
library(tidyverse)
# Chunk 3
url <- "https://raw.githubusercontent.com/torra034-svg/biostats/refs/heads/main/Biostats%202/Data%20Stuff/tomhs.csv"
tomhs <- read_csv(url)
rm(url)
tomhs <- tomhs %>%
mutate(wtchg = wt12 - wtbl,
cholchg = chol12 - cholbl)
tomhs <- tomhs %>%
mutate(wtchg = wt12 - wtbl,
cholchg = chol12 - cholbl)
model <- lm(data = tomhs, cholchg ~ wtchg)
summary(model)
model <- lm(data = tomhs, cholchg ~ wtchg)
summary(model)
tomhs <- tomhs %>%
mutate(nowsmk = fct_relevel(.f = nowsmk, "2")) #set non-smokers as reference level
tomhs <- tomhs %>%
mutate(nowsmk = fct_relevel(nowsmk, "2")) #set non-smokers as reference level
tomhs <- tomhs %>%
mutate(nowsmk = fct_relevel(nowsmk, "2")) #set non-smokers as reference level
tomhs <- tomhs %>%
mutate(nowsmk = fct_relevel(as.factor(nowsmk), "2")) #set non-smokers as reference level
model_adjust <- lm(data = tomhs, cholchg ~ wtchg + now_smk)
model_adjust <- lm(data = tomhs, cholchg ~ wtchg + nowsmk)
summary(model_adjust)
summary(model_adjust)$adj.r.squared
summary(model)$adj.r.squared
summary(model)$adj.r.squared
residuals_unadjusted <- resid(model)
leverage_unadjusted <- hatvalues(model)
PRESS_unadjusted <- sum((residuals / (1-leverage))^2)
summary(model)$adj.r.squared
residuals_unadjusted <- resid(model)
leverage_unadjusted <- hatvalues(model)
PRESS_unadjusted <- sum((residuals_unadjusted / (1-leverage_unadjusted))^2)
summary(model)$adj.r.squared
residuals_unadjusted <- resid(model)
leverage_unadjusted <- hatvalues(model)
PRESS_unadjusted <- sum((residuals_unadjusted / (1-leverage_unadjusted))^2)
PRESS_unadjusted
summary(model_adjust)$adj.r.squared
residuals_adjusted <- resid(model)
leverage_adjusted <- hatvalues(model)
PRESS_adjusted <- sum((residuals_adjusted / (1-leverage_adjusted))^2)
PRESS_adjusted
residuals_adjusted <- resid(model_adjust)
leverage_adjusted <- hatvalues(model_adjust)
PRESS_adjusted <- sum((residuals_adjusted / (1-leverage_adjusted))^2)
PRESS_adjusted
summary(model_adjust)$adj.r.squared
residuals_adjusted <- resid(model_adjust)
leverage_adjusted <- hatvalues(model_adjust)
PRESS_adjusted <- sum((residuals_adjusted / (1-leverage_adjusted))^2)
PRESS_adjusted
ggplot(tomhs, aes(x = wtchg, y = cholchg)) +
geom_point() +
labs(x = "Weight change (lb)",
y = "Total Cholesterol Change",
title = "Total Cholesterol Change vs Weight Change")
par(mfrow = c(2,2))
plot(model_adjust)
par(mfrow = c(2,2))
plot(model_adjust)
