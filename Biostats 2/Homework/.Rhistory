library(tidyverse)
library(gtsummary)
library(performance)
library(see)
tomhs <- read.csv(file = "C:/Users/Lenovo/OneDrive/Documents/Biostats 2/Data Stuff/tomhs.csv", header = TRUE)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2
library(tidyverse)
library(gtsummary)
library(performance)
library(see)
# Chunk 3
tomhs <- read.csv(file = "C:/Users/Lenovo/OneDrive/Documents/Biostats 2/Data Stuff/tomhs.csv", header = TRUE)
# Chunk 4: data cleaning
RQ1 <- tomhs %>%
select(wtbl,wt12,cholbl,chol12, sex) %>%
mutate("weight_change" = wt12-wtbl,
"cholesterol_change" = chol12-cholbl,
"Sex" = if_else(sex == 1, "Male", "Female"))
RQ1
# Chunk 5: RQ1_model summary
RQ1_model <- lm(data = RQ1, cholesterol_change ~ weight_change)
summary(RQ1_model)
# Chunk 6: RQ1_model 95% CI
RQ1_CI <- confint(RQ1_model)
RQ1_CI
# Chunk 7: RQ1 graph
ggplot(RQ1, aes(x = weight_change, y = cholesterol_change)) +
geom_point() +
labs(x = "Weight Change",
y = "Cholesterol Change",
title = "Figure 1. Unadjusted Linear Relationship between Weight Change vs Cholesterol Change") +
geom_smooth(se = FALSE, method = "lm")
# Chunk 8: RQ2 model summary
RQ2_model <- lm(data = RQ1, cholesterol_change ~ weight_change + factor(sex))
summary(RQ2_model)
# Chunk 9: RQ2_model 95% CI
RQ2_CI <- confint(RQ2_model)
RQ2_CI
# Chunk 10: RQ2 graph
ggplot(RQ1, aes(x = weight_change, y = cholesterol_change, color = Sex)) +
geom_point() +
labs(x = "Weight Change",
y = "Cholesterol Change",
title = "Figure 2. Linear Relationship between Weight Change vs Cholesterol Change by Sex") +
geom_smooth(se = FALSE, method = "lm")
# Chunk 11: diagnostic plots
par(mfrow = c(2,2))
plot(RQ2_model)
# Chunk 12: t1 data cleaning
t1 <- tomhs %>%
select(age,sex,race,income,marital,educ,eversmk,nowsmk) %>%
mutate(Sex = if_else(sex == 1, "Male", "Female"),
Race = case_when(race == 1 ~ "White",
race == 2 ~ "Black",
race == 3 ~ "Asian",
race == 4 ~ "Other"),
Income = case_when(income == 1 ~ "Less than $9,999",
income == 2 ~ "$10,000 to $19,999",
income == 3 ~ "$20,000 to $29,999",
income == 4 ~ "$30,000 to $39,999",
income == 5 ~ "$40,000 to $49,999",
income == 6 ~ "$50,000 to $59,999",
income == 7 ~ "$60,000 to $69,999",
income == 8 ~ "$70,000 or more"),
Marital = case_when(marital == 1 ~ "Never married",
marital == 2 ~ "Separated",
marital == 3 ~ "Divorced",
marital == 4 ~ "Widowed",
marital == 5 ~ "Married"),
Education = case_when(educ == 1 ~"Eighth grade or less",
educ == 2 ~"Trade school or business school instead of high school",
educ == 3 ~"Some high school",
educ == 4 ~"High school graduate",
educ == 5 ~"Trade school or business school after graduating from high school",
educ == 6 ~"Some college including 2 year degrees",
educ == 7 ~"Received bachelor's degree",
educ == 8 ~"Graduate or professional education beyond the bachelor's degree",
educ == 9 ~ "Graduate or professional degree (Specify):"),
"Ever Smoked" = if_else(eversmk == 1, "Yes", "No"),
"Current Smoker" = if_else(nowsmk == 1, "Yes", "No")) %>%
select(-sex,-race,-income,-marital,-educ,-eversmk,-nowsmk)
# Chunk 13: table summary
t1_sum <- tbl_summary(t1) %>%
modify_caption("**Table 1. TOMHS Study Patient Demographics**")
t1_sum
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2
library(tidyverse)
library(gtsummary)
library(performance)
library(see)
# Chunk 3
tomhs <- read.csv(file = "C:/Users/Lenovo/OneDrive/Documents/Biostats 2/Data Stuff/tomhs.csv", header = TRUE)
# Chunk 4: data cleaning
RQ1 <- tomhs %>%
select(wtbl,wt12,cholbl,chol12, sex) %>%
mutate("weight_change" = wt12-wtbl,
"cholesterol_change" = chol12-cholbl,
"Sex" = if_else(sex == 1, "Male", "Female"))
RQ1
# Chunk 5: RQ1_model summary
RQ1_model <- lm(data = RQ1, cholesterol_change ~ weight_change)
summary(RQ1_model)
# Chunk 6: RQ1_model 95% CI
RQ1_CI <- confint(RQ1_model)
RQ1_CI
# Chunk 7: RQ1 graph
ggplot(RQ1, aes(x = weight_change, y = cholesterol_change)) +
geom_point() +
labs(x = "Weight Change",
y = "Cholesterol Change",
title = "Figure 1. Unadjusted Linear Relationship between Weight Change vs Cholesterol Change") +
geom_smooth(se = FALSE, method = "lm")
# Chunk 8: RQ2 model summary
RQ2_model <- lm(data = RQ1, cholesterol_change ~ weight_change + factor(sex))
summary(RQ2_model)
# Chunk 9: RQ2_model 95% CI
RQ2_CI <- confint(RQ2_model)
RQ2_CI
# Chunk 10: RQ2 graph
ggplot(RQ1, aes(x = weight_change, y = cholesterol_change, color = Sex)) +
geom_point() +
labs(x = "Weight Change",
y = "Cholesterol Change",
title = "Figure 2. Linear Relationship between Weight Change vs Cholesterol Change by Sex") +
geom_smooth(se = FALSE, method = "lm")
# Chunk 11: diagnostic plots
par(mfrow = c(2,2))
plot(RQ2_model)
# Chunk 12: t1 data cleaning
t1 <- tomhs %>%
select(age,sex,race,income,marital,educ,eversmk,nowsmk) %>%
mutate(Sex = if_else(sex == 1, "Male", "Female"),
Race = case_when(race == 1 ~ "White",
race == 2 ~ "Black",
race == 3 ~ "Asian",
race == 4 ~ "Other"),
Income = case_when(income == 1 ~ "Less than $9,999",
income == 2 ~ "$10,000 to $19,999",
income == 3 ~ "$20,000 to $29,999",
income == 4 ~ "$30,000 to $39,999",
income == 5 ~ "$40,000 to $49,999",
income == 6 ~ "$50,000 to $59,999",
income == 7 ~ "$60,000 to $69,999",
income == 8 ~ "$70,000 or more"),
Marital = case_when(marital == 1 ~ "Never married",
marital == 2 ~ "Separated",
marital == 3 ~ "Divorced",
marital == 4 ~ "Widowed",
marital == 5 ~ "Married"),
Education = case_when(educ == 1 ~"Eighth grade or less",
educ == 2 ~"Trade school or business school instead of high school",
educ == 3 ~"Some high school",
educ == 4 ~"High school graduate",
educ == 5 ~"Trade school or business school after graduating from high school",
educ == 6 ~"Some college including 2 year degrees",
educ == 7 ~"Received bachelor's degree",
educ == 8 ~"Graduate or professional education beyond the bachelor's degree",
educ == 9 ~ "Graduate or professional degree (Specify):"),
"Ever Smoked" = if_else(eversmk == 1, "Yes", "No"),
"Current Smoker" = if_else(nowsmk == 1, "Yes", "No")) %>%
select(-sex,-race,-income,-marital,-educ,-eversmk,-nowsmk)
# Chunk 13: table summary
t1_sum <- tbl_summary(t1) %>%
modify_caption("**Table 1. TOMHS Study Patient Demographics**")
t1_sum
tomhs <- read.csv(https://github.com/torra034-svg/biostats/blob/main/Biostats%202/Data%20Stuff/tomhs.csv)
tomhs <- read.csv("https:\\github.com\torra034-svg\biostats\blob\main\Biostats%202\Data%20Stuff\tomhs.csv")
url <- https:\\github.com\torra034-svg\biostats\blob\main\Biostats%202\Data%20Stuff\tomhs.csv
url <- https://github.com/torra034-svg/biostats/blob/main/Biostats%202/Data%20Stuff/tomhs.csv
url <- "https://github.com/torra034-svg/biostats/blob/main/Biostats%202/Data%20Stuff/tomhs.csv"
tomhs <- read.csv("https:\\github.com\torra034-svg\biostats\blob\main\Biostats%202\Data%20Stuff\tomhs.csv")
url <- "https://github.com/torra034-svg/biostats/blob/main/Biostats%202/Data%20Stuff/tomhs.csv"
tomhs <- read.csv(url)
url <- "https:\\github.com\torra034-svg\biostats\blob\main\Biostats%202\Data%20Stuff\tomhs.csv"
url <- "https://github.com/torra034-svg/biostats/blob/main/Biostats%202/Data%20Stuff/tomhs.csv"
tomhs <- read_csv(url)
url <- "https://github.com/torra034-svg/biostats/blob/main/Biostats%202/Data%20Stuff/tomhs.csv"
tomhs <- read.csv(url)
url <- "https://github.com/torra034-svg/biostats/blob/main/Biostats%202/Data%20Stuff/tomhs.csv"
tomhs <- read.csv(url)
url <- "https://raw.githubusercontent.com/torra034-svg/biostats/refs/heads/main/Biostats%202/Data%20Stuff/tomhs.csv"
tomhs <- read.csv(url)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2
library(tidyverse)
library(gtsummary)
library(performance)
library(see)
# Chunk 3
url <- "https://raw.githubusercontent.com/torra034-svg/biostats/refs/heads/main/Biostats%202/Data%20Stuff/tomhs.csv"
tomhs <- read.csv(url)
# Chunk 4: data cleaning
RQ1 <- tomhs %>%
select(wtbl,wt12,cholbl,chol12, sex) %>%
mutate("weight_change" = wt12-wtbl,
"cholesterol_change" = chol12-cholbl,
"Sex" = if_else(sex == 1, "Male", "Female"))
RQ1
# Chunk 5: RQ1_model summary
RQ1_model <- lm(data = RQ1, cholesterol_change ~ weight_change)
summary(RQ1_model)
# Chunk 6: RQ1_model 95% CI
RQ1_CI <- confint(RQ1_model)
RQ1_CI
# Chunk 7: RQ1 graph
ggplot(RQ1, aes(x = weight_change, y = cholesterol_change)) +
geom_point() +
labs(x = "Weight Change",
y = "Cholesterol Change",
title = "Figure 1. Unadjusted Linear Relationship between Weight Change vs Cholesterol Change") +
geom_smooth(se = FALSE, method = "lm")
# Chunk 8: RQ2 model summary
RQ2_model <- lm(data = RQ1, cholesterol_change ~ weight_change + factor(sex))
summary(RQ2_model)
# Chunk 9: RQ2_model 95% CI
RQ2_CI <- confint(RQ2_model)
RQ2_CI
# Chunk 10: RQ2 graph
ggplot(RQ1, aes(x = weight_change, y = cholesterol_change, color = Sex)) +
geom_point() +
labs(x = "Weight Change",
y = "Cholesterol Change",
title = "Figure 2. Linear Relationship between Weight Change vs Cholesterol Change by Sex") +
geom_smooth(se = FALSE, method = "lm")
# Chunk 11: diagnostic plots
par(mfrow = c(2,2))
plot(RQ2_model)
# Chunk 12: t1 data cleaning
t1 <- tomhs %>%
select(age,sex,race,income,marital,educ,eversmk,nowsmk) %>%
mutate(Sex = if_else(sex == 1, "Male", "Female"),
Race = case_when(race == 1 ~ "White",
race == 2 ~ "Black",
race == 3 ~ "Asian",
race == 4 ~ "Other"),
Income = case_when(income == 1 ~ "Less than $9,999",
income == 2 ~ "$10,000 to $19,999",
income == 3 ~ "$20,000 to $29,999",
income == 4 ~ "$30,000 to $39,999",
income == 5 ~ "$40,000 to $49,999",
income == 6 ~ "$50,000 to $59,999",
income == 7 ~ "$60,000 to $69,999",
income == 8 ~ "$70,000 or more"),
Marital = case_when(marital == 1 ~ "Never married",
marital == 2 ~ "Separated",
marital == 3 ~ "Divorced",
marital == 4 ~ "Widowed",
marital == 5 ~ "Married"),
Education = case_when(educ == 1 ~"Eighth grade or less",
educ == 2 ~"Trade school or business school instead of high school",
educ == 3 ~"Some high school",
educ == 4 ~"High school graduate",
educ == 5 ~"Trade school or business school after graduating from high school",
educ == 6 ~"Some college including 2 year degrees",
educ == 7 ~"Received bachelor's degree",
educ == 8 ~"Graduate or professional education beyond the bachelor's degree",
educ == 9 ~ "Graduate or professional degree (Specify):"),
"Ever Smoked" = if_else(eversmk == 1, "Yes", "No"),
"Current Smoker" = if_else(nowsmk == 1, "Yes", "No")) %>%
select(-sex,-race,-income,-marital,-educ,-eversmk,-nowsmk)
# Chunk 13: table summary
t1_sum <- tbl_summary(t1) %>%
modify_caption("**Table 1. TOMHS Study Patient Demographics**")
t1_sum
RQ2_model <- lm(data = RQ1, cholesterol_change ~ weight_change + factor(sex))
summary(RQ2_model)
RQ1_model <- lm(data = RQ1, cholesterol_change ~ weight_change)
summary(RQ1_model)
RQ2_model <- lm(data = RQ1, cholesterol_change ~ weight_change + factor(sex))
summary(RQ2_model)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2: load library
library(tidyverse)
library(car)
library(olsrr)
# Chunk 3: load tomhs data from github
url <- "https://raw.githubusercontent.com/torra034-svg/biostats/refs/heads/main/Biostats%202/Data%20Stuff/tomhs.csv"
tomhs <- read_csv(url)
# Chunk 4: remove url
rm(url)
# Chunk 5: q1 create variables
tomhs <- tomhs %>%
mutate(wtchg = wt12 - wtbl,
cholchg = chol12 - cholbl)
# Chunk 6: q2 MLR model
model_adjusted <- lm(data = tomhs, cholchg ~ wtchg + nowsmk)
summary(model_adjusted)
# Chunk 7: q3 check for outliers via cooks model
n <- nobs(model_adjusted) #define number of observations first in the model
which(cooks.distance(model_adjusted) > 4/n) #this line identifies outliers
# Chunk 8: q4 check standardized residuals
which(abs(rstandard(model_adjusted)) > 2) # make sure to only look at bottom row as the observation output. Ignore the top row.
# Chunk 9: q5 check for strong standardized residuals
which(abs(rstandard(model_adjusted)) > 3) # this checks for strong residuals
# Chunk 10: q6 studentized residuals
rstudent(model_adjusted) #studentized residuals tell us how many st.dev away an observed value is from the predicted value
# Chunk 11: q7 studentized residuals of concern
which(abs(rstudent(model_adjusted))>3) #again ignore the top row bc that is the character position. The true observation output is in the second row.
# Chunk 12: q11 cooks distance
cooks.distance(model_adjusted)
# Chunk 13: q13 DFFITS plot
ols_plot_dffits(model_adjusted)
# Chunk 14: q14 DFFITS values of concern
p <- length(coef(model_adjusted)) #number of parameters
threshold <- 2 * sqrt(p / n)
which(abs(dffits(model_adjusted)) > threshold )
# Chunk 15: q15 DFBETAS
DFBETAS <- dfbetas(model_adjusted)
dfbeta_flag <- which(abs(DFBETAS) > 1)
# Chunk 16: q19 multicollinearity
vif(model_adjusted)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2
tomhs <- read.csv(file = "C:/Users/Lenovo/OneDrive/Documents/Biostats 2/Data Stuff/tomhs.csv", header = TRUE)
# Chunk 3
library(tidyverse)
library(summarytools)
library(psych)
# Chunk 4
tomhs1 <- tomhs %>%
mutate("wtchg" = wt12 - wtbl,
"cholchg" = chol12 - cholbl)
# Chunk 5
tomhs1 %>%
select(ptid, wtchg, wt12, wtbl, cholchg, chol12, cholbl) %>%
slice_sample(n = 3)
# Chunk 6
descr(tomhs1$cholchg)
describe(tomhs1$cholchg)
# Chunk 7
ggplot(tomhs1, aes(x = cholchg)) +
geom_histogram()
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2
library(tidyverse)
library(gtsummary)
library(performance)
library(see)
# Chunk 3
url <- "https://raw.githubusercontent.com/torra034-svg/biostats/refs/heads/main/Biostats%202/Data%20Stuff/tomhs.csv"
tomhs <- read.csv(url)
# Chunk 4: data cleaning
RQ1 <- tomhs %>%
select(wtbl,wt12,cholbl,chol12, sex) %>%
mutate("weight_change" = wt12-wtbl,
"cholesterol_change" = chol12-cholbl,
"Sex" = if_else(sex == 1, "Male", "Female"))
RQ1
# Chunk 5: RQ1_model summary
RQ1_model <- lm(data = RQ1, cholesterol_change ~ weight_change)
summary(RQ1_model)
# Chunk 6: RQ1_model 95% CI
RQ1_CI <- confint(RQ1_model)
RQ1_CI
# Chunk 7: RQ1 graph
ggplot(RQ1, aes(x = weight_change, y = cholesterol_change)) +
geom_point() +
labs(x = "Weight Change",
y = "Cholesterol Change",
title = "Figure 1. Unadjusted Linear Relationship between Weight Change vs Cholesterol Change") +
geom_smooth(se = FALSE, method = "lm")
# Chunk 8: RQ2 model summary
RQ2_model <- lm(data = RQ1, cholesterol_change ~ weight_change + factor(sex))
summary(RQ2_model)
# Chunk 9: RQ2_model 95% CI
RQ2_CI <- confint(RQ2_model)
RQ2_CI
# Chunk 10: RQ2 graph
ggplot(RQ1, aes(x = weight_change, y = cholesterol_change, color = Sex)) +
geom_point() +
labs(x = "Weight Change",
y = "Cholesterol Change",
title = "Figure 2. Linear Relationship between Weight Change vs Cholesterol Change by Sex") +
geom_smooth(se = FALSE, method = "lm")
# Chunk 11: diagnostic plots
par(mfrow = c(2,2))
plot(RQ2_model)
# Chunk 12: t1 data cleaning
t1 <- tomhs %>%
select(age,sex,race,income,marital,educ,eversmk,nowsmk) %>%
mutate(Sex = if_else(sex == 1, "Male", "Female"),
Race = case_when(race == 1 ~ "White",
race == 2 ~ "Black",
race == 3 ~ "Asian",
race == 4 ~ "Other"),
Income = case_when(income == 1 ~ "Less than $9,999",
income == 2 ~ "$10,000 to $19,999",
income == 3 ~ "$20,000 to $29,999",
income == 4 ~ "$30,000 to $39,999",
income == 5 ~ "$40,000 to $49,999",
income == 6 ~ "$50,000 to $59,999",
income == 7 ~ "$60,000 to $69,999",
income == 8 ~ "$70,000 or more"),
Marital = case_when(marital == 1 ~ "Never married",
marital == 2 ~ "Separated",
marital == 3 ~ "Divorced",
marital == 4 ~ "Widowed",
marital == 5 ~ "Married"),
Education = case_when(educ == 1 ~"Eighth grade or less",
educ == 2 ~"Trade school or business school instead of high school",
educ == 3 ~"Some high school",
educ == 4 ~"High school graduate",
educ == 5 ~"Trade school or business school after graduating from high school",
educ == 6 ~"Some college including 2 year degrees",
educ == 7 ~"Received bachelor's degree",
educ == 8 ~"Graduate or professional education beyond the bachelor's degree",
educ == 9 ~ "Graduate or professional degree (Specify):"),
"Ever Smoked" = if_else(eversmk == 1, "Yes", "No"),
"Current Smoker" = if_else(nowsmk == 1, "Yes", "No")) %>%
select(-sex,-race,-income,-marital,-educ,-eversmk,-nowsmk)
# Chunk 13: table summary
t1_sum <- tbl_summary(t1) %>%
modify_caption("**Table 1. TOMHS Study Patient Demographics**")
t1_sum
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2: library
library(tidyverse)
library(interactions)
install.packages("interactions")
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2: library
library(tidyverse)
library(interactions)
# Chunk 3: import data
url <- "https://raw.githubusercontent.com/torra034-svg/biostats/refs/heads/main/Biostats%202/Data%20Stuff/tomhs.csv"
tomhs <- read.csv(url)
# Chunk 4: data cleaning
tomhs <- tomhs %>%
mutate(wtchg = wt12 - wtbl,
cholchg = chol12 - cholbl,
nowsmk1 = if_else(nowsmk == 1, "Current Smoker", "Non-current Smoker", missing = NA))
# Chunk 5: remove values
rm(url)
# Chunk 6: q1
tomhs$nowsmk
# Chunk 7: model
model <- lm(data = tomhs, cholchg ~ wtchg * nowsmk1)
# Chunk 8: q2 - interaction plot via interaction package
interact_plot(model, pred = wtchg, modx = nowsmk1,
interval = TRUE,
plot.points = TRUE,
x.label = "Weight Change",
y.label = "Cholesterol Change",
legend.main = "Current Smoking Status",
main.title = "Cholesterol Change vs Weight Change by Smoking Status")
# Chunk 9: q5 - factor relevel
tomhs <- tomhs %>%
mutate(nowsmk1 = fct_relevel(nowsmk1, "Non-current Smoker"))
# Chunk 10: q5 model fit
model1 <- lm(data = tomhs, cholchg ~ wtchg * nowsmk1)
# Chunk 11: q6 examine model1 output
summary(model1)
# Chunk 12: q12 - confint and standard error
confint(model1)
emmeans(model1, ~ nowsmk1 | Current Smoking)
View(model)
?interact_plot()
interact_plot(model, pred = wtchg, modx = nowsmk1,
interval = TRUE,
plot.points = TRUE,
x.label = "Weight Change",
y.label = "Cholesterol Change",
legend.main = "Current Smoking Status",
main.title = "Cholesterol Change vs Weight Change by Smoking Status")
